{% extends 'home/base.html' %}

{% block content %}
<style>
    :root {
        --soft-bg: #fdfcfb;
        --gold-gradient: linear-gradient(45deg, #c5a059, #e9d5a1);
        --brown-deep: #3e2723;
        --glass-shadow: 0 8px 32px rgba(0,0,0,0.05);
    }

    /* BANNER */
    .profile-banner {
        background: linear-gradient(135deg, #4e342e 0%, #6d4c41 100%);
        border-radius: 30px;
        padding: 50px 20px;
        color: white;
        text-align: center;
        position: relative;
        box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        margin-bottom: -40px;
        z-index: 1;
    }

    .avatar-wrapper {
        width: 120px; height: 120px;
        background: white;
        border-radius: 50%;
        margin: 0 auto 15px;
        display: flex; align-items: center; justify-content: center;
        border: 5px solid rgba(197, 160, 89, 0.5);
        box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }
    .avatar-wrapper i { font-size: 3.5rem; color: var(--brown-deep); }

    /* KARTY */
    .p-card {
        background: white;
        border-radius: 25px;
        border: 1px solid rgba(0,0,0,0.03);
        box-shadow: var(--glass-shadow);
        padding: 25px;
        height: 100%;
        transition: 0.3s;
    }
    .p-card:hover { transform: translateY(-5px); }

    .p-label {
        font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px;
        color: #a1887f; font-weight: 700; margin-bottom: 5px; display: block;
    }

    .p-value { font-weight: 600; color: var(--brown-deep); font-size: 1.05rem; }

    /* TLAƒå√çTKA */
    .btn-edit {
        background: var(--gold-gradient);
        border: none; color: #3e2723;
        font-weight: 700; border-radius: 15px;
        padding: 12px; width: 100%;
        transition: 0.3s;
    }
    .btn-edit:hover { filter: brightness(1.1); transform: scale(1.02); }

    .list-item-custom {
        border: none; background: #fbf9f7;
        margin-bottom: 10px; border-radius: 15px;
        padding: 15px;
    }

    .hover-light:hover { background: #fdfcfb; transform: scale(1.05); transition: 0.2s; }
</style>

<div class="container pb-5">
    <div class="profile-banner">
        <div class="avatar-wrapper">
            <i class="fas fa-user-circle"></i>
        </div>
        <h2 class="fw-bold mb-1" style="font-family: 'Playfair Display', serif;">{{ user.username }}</h2>
        <p class="opacity-75 mb-3">{{ user.email }}</p>

        {% if profil.je_premium %}
            <div class="premium-badge">
                <i class="fas fa-crown"></i> PREMIUM CHOVATEL
            </div>
        {% endif %}
    </div>

    <div class="row g-4 mt-1" style="position: relative; z-index: 2;">
        <div class="col-lg-4">
            <div class="p-card">
                <h5 class="fw-bold mb-4" style="color: var(--brown-deep);">Osobn√≠ √∫daje</h5>
                <div class="mb-3">
                    <span class="p-label">Jm√©no a p≈ô√≠jmen√≠</span>
                    <div class="p-value">{{ user.first_name }} {{ user.last_name|default:"Chovatel" }}</div>
                </div>
                <div class="mb-3">
                    <span class="p-label">Telefon</span>
                    <div class="p-value">{{ profil.telefon|default:"+420 --- --- ---" }}</div>
                </div>
                <div class="mb-4">
                    <span class="p-label">ƒålenem od</span>
                    <div class="p-value">{{ user.date_joined|date:"j. F Y" }}</div>
                </div>

                <button type="button" class="btn-edit shadow-sm" data-bs-toggle="modal" data-bs-target="#editProfileModal">
                    <i class="fas fa-pen-nib me-2"></i>Upravit √∫daje
                </button>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="p-card">
                        <h5 class="fw-bold mb-3"><i class="fas fa-heart text-danger me-2"></i>Moje srd√≠ƒçka</h5>
                        {% for post in libi_se_mi %}
                        <div class="list-item-custom d-flex justify-content-between align-items-center">
                            <span class="small fw-bold">{{ post.plemeno.nazev }}</span>
                        </div>
                        {% empty %}
                        <p class="text-muted small">Zat√≠m ≈æ√°dn√° srd√≠ƒçka.</p>
                        {% endfor %}
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="p-card">
                        <h5 class="fw-bold mb-3"><i class="fas fa-comment-alt text-primary me-2"></i>Koment√°≈ôe</h5>
                        {% for kom in komentare|slice:":3" %}
                        <div class="list-item-custom small">"{{ kom.text|truncatechars:50 }}"</div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="p-card mt-4">
                <h5 class="fw-bold mb-4"><i class="fas fa-paw text-warning me-2"></i>Moje ps√≠ centrum</h5>
                <div class="row g-3">
                    <div class="col-4">
                        <a href="{% url 'seznam_psu' %}" class="text-decoration-none text-center d-block p-3 rounded-4 hover-light text-dark">
                            <div class="fs-2 mb-1">üêï</div>
                            <div class="small fw-bold">Moji psi</div>
                        </a>
                    </div>
                    <div class="col-4 border-start border-end">
                        <a href="{% url 'pridat_psa' %}" class="text-decoration-none text-center d-block p-3 rounded-4 hover-light text-dark">
                            <div class="fs-2 mb-1">‚ú®</div>
                            <div class="small fw-bold">Nov√Ω pes</div>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="{% url 'veterinar' %}" class="text-decoration-none text-center d-block p-3 rounded-4 hover-light text-dark">
                            <div class="fs-2 mb-1">üè•</div>
                            <div class="small fw-bold">Veterin√°≈ô</div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="editProfileModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow" style="border-radius: 30px; background: var(--soft-bg);">
            <div class="modal-header border-0 pt-4 px-4">
                <h4 class="fw-bold mb-0" style="color: var(--brown-deep); font-family: 'Playfair Display', serif;">Upravit profil</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="POST" action="{% url 'upravit_profil' %}">
                {% csrf_token %}
                <div class="modal-body p-4">
                    <div class="mb-3">
                        <label class="p-label">Jm√©no</label>
                        <input type="text" name="first_name" class="form-control rounded-4 p-3 border-0 shadow-sm" value="{{ user.first_name }}">
                    </div>
                    <div class="mb-3">
                        <label class="p-label">P≈ô√≠jmen√≠</label>
                        <input type="text" name="last_name" class="form-control rounded-4 p-3 border-0 shadow-sm" value="{{ user.last_name }}">
                    </div>
                    <div class="mb-3">
                        <label class="p-label">Telefon</label>
                        <input type="text" name="telefon" class="form-control rounded-4 p-3 border-0 shadow-sm" value="{{ profil.telefon }}">
                    </div>
                    <button type="submit" class="btn-edit mt-2 shadow">Ulo≈æit zmƒõny</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}